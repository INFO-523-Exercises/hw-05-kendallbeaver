<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>hw05</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hw-05_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw-05_files/libs/quarto-html/quarto.js"></script>
<script src="hw-05_files/libs/quarto-html/popper.min.js"></script>
<script src="hw-05_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw-05_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw-05_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw-05_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw-05_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw-05_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw-05_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">hw05</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="analyzing-parasites-killing-bee-colonies-in-arizona-from-2015---2021" class="level1">
<h1>Analyzing Parasites Killing Bee Colonies in Arizona From 2015 - 2021</h1>
<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>Two national datasets regarding bee populations (“colony.csv”) and stressors causing bee population decline (“stressor.csv”) were analyzed for the purposes of analyzing and predicting liner regression. Data in both datasets have been categorized based on season and the two main culprits leading to population decline are “Varroa mites” followed by “Other pests/parasites”.</p>
<p>Varroa mites are parasites that feed off the bodily fluids of adult bees and younger, newborn bees within a bee population, leading to a significant decline in bee population across the entire nation. This assignment looks to analyze the linear affect that this parasite specifically has on the Arizona bee population from 2015 - 2021.</p>
</section>
<section id="data-preprocessing-import-packages-two-datasets" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing-import-packages-two-datasets">Data Preprocessing: Import Packages &amp; Two Datasets</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidymodels,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               dplyr,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               tibble,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               tidyverse,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               ranger,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>               randomForest,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>               glmnet,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>               here,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>               formattable,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>               dlookr,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>               yardstick,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>               ggplot,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>               gplots,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>               caret,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>               gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/kendallbeaver/AppData/Local/R/win-library/4.3'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot' is not available for this version of R

A version of this package for your version of R might be available elsewhere,
see the ideas at
https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: unable to access index for repository http://www.stats.ox.ac.uk/pub/RWin/bin/windows/contrib/4.3:
  cannot open URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/windows/contrib/4.3/PACKAGES'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'BiocManager' not available.  Could not check Bioconductor.

Please use `install.packages('BiocManager')` and then retry.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in p_install(package, character.only = TRUE, ...):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE, : there is no package called 'ggplot'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in pacman::p_load(tidymodels, dplyr, tibble, tidyverse, ranger, : Failed to install/load:
ggplot</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import two correlated datasets, "colony" and "stressor": </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read colony data (dataset is from 2015 - 2021)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>colony <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">'./data/colony.csv'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1222 Columns: 10</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): months, state
dbl (8): year, colony_n, colony_max, colony_lost, colony_lost_pct, colony_ad...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>arizona_colony <span class="ot">&lt;-</span> <span class="fu">filter</span>(colony, state <span class="sc">%in%</span> <span class="st">"Arizona"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>arizona_colony</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26 × 10
    year months           state  colony_n colony_max colony_lost colony_lost_pct
   &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
 1  2015 January-March    Arizo…    35000      35000        4600              13
 2  2015 April-June       Arizo…    33000      33000        5500              17
 3  2015 July-September   Arizo…    40000      40000        6000              15
 4  2015 October-December Arizo…    36000      39000       12000              31
 5  2016 January-March    Arizo…    30000      30000        4700              16
 6  2016 April-June       Arizo…    22000      23000        3700              16
 7  2016 July-September   Arizo…    30000      32000        6000              19
 8  2016 October-December Arizo…    29000      31000        6500              21
 9  2017 January-March    Arizo…    31000      32000        6000              19
10  2017 April-June       Arizo…    22000      22000        2600              12
# ℹ 16 more rows
# ℹ 3 more variables: colony_added &lt;dbl&gt;, colony_reno &lt;dbl&gt;,
#   colony_reno_pct &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read stressor data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>stressor <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">'./data/stressor.csv'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 7332 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): months, state, stressor
dbl (2): year, stress_pct

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>arizona_stressor <span class="ot">&lt;-</span> <span class="fu">filter</span>(stressor, state <span class="sc">%in%</span> <span class="st">"Arizona"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>arizona_stressor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 156 × 5
    year months        state   stressor              stress_pct
   &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt;                      &lt;dbl&gt;
 1  2015 January-March Arizona Varroa mites                26.9
 2  2015 January-March Arizona Other pests/parasites       20.5
 3  2015 January-March Arizona Disesases                    0.1
 4  2015 January-March Arizona Pesticides                  NA  
 5  2015 January-March Arizona Other                        1.8
 6  2015 January-March Arizona Unknown                      3.1
 7  2015 April-June    Arizona Varroa mites                 8.4
 8  2015 April-June    Arizona Other pests/parasites       32.1
 9  2015 April-June    Arizona Disesases                    0.5
10  2015 April-June    Arizona Pesticides                  20.1
# ℹ 146 more rows</code></pre>
</div>
</div>
</section>
<section id="data-preprocessing-cleaning-colony-dataset" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing-cleaning-colony-dataset">Data Preprocessing: Cleaning “Colony” Dataset</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze "arizona_colony" data: </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>arizona_colony <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year         months             state              colony_n    
 Min.   :2015   Length:26          Length:26          Min.   :18500  
 1st Qu.:2016   Class :character   Class :character   1st Qu.:26000  
 Median :2018   Mode  :character   Mode  :character   Median :28000  
 Mean   :2018                                         Mean   :28260  
 3rd Qu.:2019                                         3rd Qu.:31000  
 Max.   :2021                                         Max.   :40000  
                                                      NA's   :1      
   colony_max     colony_lost    colony_lost_pct  colony_added  
 Min.   :19500   Min.   : 1300   Min.   : 5.00   Min.   :  150  
 1st Qu.:26000   1st Qu.: 4000   1st Qu.:15.00   1st Qu.: 2200  
 Median :30000   Median : 5500   Median :17.00   Median : 3400  
 Mean   :29380   Mean   : 5292   Mean   :17.68   Mean   : 5384  
 3rd Qu.:32000   3rd Qu.: 6500   3rd Qu.:21.00   3rd Qu.: 5500  
 Max.   :40000   Max.   :12000   Max.   :31.00   Max.   :19500  
 NA's   :1       NA's   :1       NA's   :1       NA's   :1      
  colony_reno      colony_reno_pct
 Min.   :   90.0   Min.   : 1.00  
 1st Qu.:  532.5   1st Qu.: 3.25  
 Median : 2100.0   Median : 9.00  
 Mean   : 3375.4   Mean   :11.73  
 3rd Qu.: 3350.0   3rd Qu.:13.75  
 Max.   :16000.0   Max.   :41.00  
 NA's   :2         NA's   :4      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values: </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>na_values_arizona_colony <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(arizona_colony))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>na_values_arizona_colony</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           year          months           state        colony_n      colony_max 
              0               0               0               1               1 
    colony_lost colony_lost_pct    colony_added     colony_reno colony_reno_pct 
              1               1               1               2               4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze and inspect the rows missing values: </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>missing_rows_arizona_colony <span class="ot">&lt;-</span> arizona_colony <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(.))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>missing_rows_arizona_colony</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 10
   year months        state   colony_n colony_max colony_lost colony_lost_pct
  &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
1  2017 January-March Arizona    31000      32000        6000              19
2  2019 January-March Arizona    22000      22000        2500              11
3  2019 April-June    Arizona       NA         NA          NA              NA
4  2020 January-March Arizona    29000      32000        6500              20
# ℹ 3 more variables: colony_added &lt;dbl&gt;, colony_reno &lt;dbl&gt;,
#   colony_reno_pct &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove "colony_reno_pct" (impute):</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>arizona_colony <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>colony_reno_pct) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 9
   year months        state   colony_n colony_max colony_lost colony_lost_pct
  &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
1  2017 January-March Arizona    31000      32000        6000              19
2  2019 April-June    Arizona       NA         NA          NA              NA
# ℹ 2 more variables: colony_added &lt;dbl&gt;, colony_reno &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>arizona_colony</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26 × 10
    year months           state  colony_n colony_max colony_lost colony_lost_pct
   &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
 1  2015 January-March    Arizo…    35000      35000        4600              13
 2  2015 April-June       Arizo…    33000      33000        5500              17
 3  2015 July-September   Arizo…    40000      40000        6000              15
 4  2015 October-December Arizo…    36000      39000       12000              31
 5  2016 January-March    Arizo…    30000      30000        4700              16
 6  2016 April-June       Arizo…    22000      23000        3700              16
 7  2016 July-September   Arizo…    30000      32000        6000              19
 8  2016 October-December Arizo…    29000      31000        6500              21
 9  2017 January-March    Arizo…    31000      32000        6000              19
10  2017 April-June       Arizo…    22000      22000        2600              12
# ℹ 16 more rows
# ℹ 3 more variables: colony_added &lt;dbl&gt;, colony_reno &lt;dbl&gt;,
#   colony_reno_pct &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't impute April-June 2019, and remove row, as this is only row with null values and entire row of data wasn't collected: </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>arizona_colony <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 10
    year months           state  colony_n colony_max colony_lost colony_lost_pct
   &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
 1  2015 January-March    Arizo…    35000      35000        4600              13
 2  2015 April-June       Arizo…    33000      33000        5500              17
 3  2015 July-September   Arizo…    40000      40000        6000              15
 4  2015 October-December Arizo…    36000      39000       12000              31
 5  2016 January-March    Arizo…    30000      30000        4700              16
 6  2016 April-June       Arizo…    22000      23000        3700              16
 7  2016 July-September   Arizo…    30000      32000        6000              19
 8  2016 October-December Arizo…    29000      31000        6500              21
 9  2017 April-June       Arizo…    22000      22000        2600              12
10  2017 July-September   Arizo…    26000      26000        4100              16
# ℹ 12 more rows
# ℹ 3 more variables: colony_added &lt;dbl&gt;, colony_reno &lt;dbl&gt;,
#   colony_reno_pct &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="data-preprocessing-analyzing-stressors-and-major-stressors-causing-decline-in-az-bee-population" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing-analyzing-stressors-and-major-stressors-causing-decline-in-az-bee-population">Data Preprocessing: Analyzing “Stressors” and Major Stressors Causing Decline in AZ Bee Population</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter stressor data: </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>arizona_stressor <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year         months             state             stressor        
 Min.   :2015   Length:156         Length:156         Length:156        
 1st Qu.:2016   Class :character   Class :character   Class :character  
 Median :2018   Mode  :character   Mode  :character   Mode  :character  
 Mean   :2018                                                           
 3rd Qu.:2019                                                           
 Max.   :2021                                                           
                                                                        
   stress_pct   
 Min.   : 0.10  
 1st Qu.: 2.75  
 Median : 6.50  
 Mean   :12.84  
 3rd Qu.:17.35  
 Max.   :98.80  
 NA's   :17     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>arizona_stressor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 156 × 5
    year months        state   stressor              stress_pct
   &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt;                      &lt;dbl&gt;
 1  2015 January-March Arizona Varroa mites                26.9
 2  2015 January-March Arizona Other pests/parasites       20.5
 3  2015 January-March Arizona Disesases                    0.1
 4  2015 January-March Arizona Pesticides                  NA  
 5  2015 January-March Arizona Other                        1.8
 6  2015 January-March Arizona Unknown                      3.1
 7  2015 April-June    Arizona Varroa mites                 8.4
 8  2015 April-June    Arizona Other pests/parasites       32.1
 9  2015 April-June    Arizona Disesases                    0.5
10  2015 April-June    Arizona Pesticides                  20.1
# ℹ 146 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rearrange stressor values from high to low:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>arizona_stressor <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(stress_pct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 156 × 5
    year months           state   stressor              stress_pct
   &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;                      &lt;dbl&gt;
 1  2016 October-December Arizona Varroa mites                98.8
 2  2017 October-December Arizona Varroa mites                61.6
 3  2017 April-June       Arizona Varroa mites                57.8
 4  2019 October-December Arizona Varroa mites                53.9
 5  2015 July-September   Arizona Varroa mites                53.5
 6  2018 July-September   Arizona Varroa mites                52.5
 7  2015 October-December Arizona Varroa mites                50.1
 8  2018 April-June       Arizona Varroa mites                48.8
 9  2016 April-June       Arizona Other pests/parasites       47.5
10  2016 July-September   Arizona Varroa mites                41.7
# ℹ 146 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze "stress_pct" distribution with a box plot:</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(arizona_stressor<span class="sc">$</span>stress_pct, <span class="at">main =</span> <span class="st">"Boxplot of stress_pct"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-05_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># "Varroa mites" are having the main effect on the declining AZ bee population from a few seasonal months in 2015-2019, followed by "Other pests/parasites" in April-June 2016, then back to "Varroa mites from a few seasonal months in 2016-2018.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-preprocessing-combine-both-datasets-based-on-population-count-and-stressors" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing-combine-both-datasets-based-on-population-count-and-stressors">Data Preprocessing: Combine Both Datasets Based on Population Count and Stressors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First filter "Stressor" dataset for top 2 stressors then concatonate with corresponding bee population from "Colony" dataset</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>top_arizona_stressors <span class="ot">&lt;-</span> arizona_stressor <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(stressor <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Varroa mites"</span>, <span class="st">"Other pests/parasites"</span>))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>top_arizona_stressors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 52 × 5
    year months           state   stressor              stress_pct
   &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;                      &lt;dbl&gt;
 1  2015 January-March    Arizona Varroa mites                26.9
 2  2015 January-March    Arizona Other pests/parasites       20.5
 3  2015 April-June       Arizona Varroa mites                 8.4
 4  2015 April-June       Arizona Other pests/parasites       32.1
 5  2015 July-September   Arizona Varroa mites                53.5
 6  2015 July-September   Arizona Other pests/parasites       24.8
 7  2015 October-December Arizona Varroa mites                50.1
 8  2015 October-December Arizona Other pests/parasites        1.7
 9  2016 January-March    Arizona Varroa mites                32.8
10  2016 January-March    Arizona Other pests/parasites        2.8
# ℹ 42 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>combined_dataset <span class="ot">&lt;-</span> <span class="fu">merge</span>(top_arizona_stressors, colony, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"months"</span>, <span class="st">"state"</span>))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>combined_dataset <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(combined_dataset)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>combined_dataset <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(stress_pct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 52 × 12
    year months        state stressor stress_pct colony_n colony_max colony_lost
   &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
 1  2016 October-Dece… Ariz… Varroa …       98.8    29000      31000        6500
 2  2017 October-Dece… Ariz… Varroa …       61.6    27000      30000        6500
 3  2017 April-June    Ariz… Varroa …       57.8    22000      22000        2600
 4  2019 October-Dece… Ariz… Varroa …       53.9    34000      36000        7000
 5  2015 July-Septemb… Ariz… Varroa …       53.5    40000      40000        6000
 6  2018 July-Septemb… Ariz… Varroa …       52.5    31000      31000        8000
 7  2015 October-Dece… Ariz… Varroa …       50.1    36000      39000       12000
 8  2018 April-June    Ariz… Varroa …       48.8    18500      19500        2600
 9  2016 April-June    Ariz… Other p…       47.5    22000      23000        3700
10  2016 July-Septemb… Ariz… Varroa …       41.7    30000      32000        6000
# ℹ 42 more rows
# ℹ 4 more variables: colony_lost_pct &lt;dbl&gt;, colony_added &lt;dbl&gt;,
#   colony_reno &lt;dbl&gt;, colony_reno_pct &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove N/A values from combined_dataset:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>combined_dataset <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(combined_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-preprocessing-finding-correlations-between-numeric-columns" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing-finding-correlations-between-numeric-columns">Data Preprocessing: Finding Correlations Between Numeric Columns</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find numeric columns in combined dataset: </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>combined_dataset <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year         months             state             stressor        
 Min.   :2015   Length:40          Length:40          Length:40         
 1st Qu.:2016   Class :character   Class :character   Class :character  
 Median :2017   Mode  :character   Mode  :character   Mode  :character  
 Mean   :2017                                                           
 3rd Qu.:2018                                                           
 Max.   :2021                                                           
   stress_pct        colony_n       colony_max     colony_lost   
 Min.   : 0.400   Min.   :18500   Min.   :19500   Min.   : 1300  
 1st Qu.: 6.275   1st Qu.:26000   1st Qu.:26000   1st Qu.: 4075  
 Median :21.350   Median :28500   Median :30000   Median : 5500  
 Mean   :25.115   Mean   :28600   Mean   :29700   Mean   : 5428  
 3rd Qu.:37.650   3rd Qu.:31500   3rd Qu.:32250   3rd Qu.: 6500  
 Max.   :98.800   Max.   :40000   Max.   :40000   Max.   :12000  
 colony_lost_pct  colony_added    colony_reno    colony_reno_pct
 Min.   : 5.00   Min.   :  300   Min.   :  180   Min.   : 1.00  
 1st Qu.:15.00   1st Qu.: 2500   1st Qu.:  960   1st Qu.: 3.00  
 Median :17.00   Median : 3500   Median : 2350   Median : 9.00  
 Mean   :18.02   Mean   : 5790   Mean   : 3675   Mean   :11.53  
 3rd Qu.:22.00   3rd Qu.: 6250   3rd Qu.: 3350   3rd Qu.:13.25  
 Max.   :31.00   Max.   :19500   Max.   :16000   Max.   :41.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to remove non-numeric columns for pairs function:</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="ot">&lt;-</span> combined_dataset <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Run combined_dataset in a correlation matrix:</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(numeric_data)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>cor_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       year  stress_pct    colony_n  colony_max colony_lost
year             1.00000000 -0.24078104 -0.41512975 -0.39308137  -0.1948171
stress_pct      -0.24078104  1.00000000  0.03499178  0.06103622   0.0359911
colony_n        -0.41512975  0.03499178  1.00000000  0.97212482   0.6079744
colony_max      -0.39308137  0.06103622  0.97212482  1.00000000   0.6494227
colony_lost     -0.19481713  0.03599110  0.60797444  0.64942274   1.0000000
colony_lost_pct -0.04505598  0.00267757  0.30928269  0.33927935   0.9242301
colony_added    -0.15016349  0.06135153 -0.33641076 -0.40459716  -0.4810766
colony_reno     -0.45065923  0.10122113  0.58512814  0.58447949   0.3942926
colony_reno_pct -0.39421121  0.09611766  0.45856935  0.45023891   0.2728926
                colony_lost_pct colony_added colony_reno colony_reno_pct
year                -0.04505598  -0.15016349  -0.4506592     -0.39421121
stress_pct           0.00267757   0.06135153   0.1012211      0.09611766
colony_n             0.30928269  -0.33641076   0.5851281      0.45856935
colony_max           0.33927935  -0.40459716   0.5844795      0.45023891
colony_lost          0.92423007  -0.48107658   0.3942926      0.27289263
colony_lost_pct      1.00000000  -0.45691799   0.1424525      0.04374420
colony_added        -0.45691799   1.00000000   0.1359665      0.26460572
colony_reno          0.14245255   0.13596651   1.0000000      0.97957303
colony_reno_pct      0.04374420   0.26460572   0.9795730      1.00000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run pairs function on filtered dataset:</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-05_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heatmap of numeric values:</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(<span class="fu">cor</span>(numeric_data), <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span>))(<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-05_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="designing-creating-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="designing-creating-linear-models">Designing &amp; Creating Linear Models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating regression model 1:</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(colony_n <span class="sc">~</span> colony_added, <span class="at">data =</span> combined_dataset)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>model1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = colony_n ~ colony_added, data = combined_dataset)

Coefficients:
 (Intercept)  colony_added  
  30554.9419       -0.3376  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating regression model 2:</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(colony_n <span class="sc">~</span> colony_lost, <span class="at">data =</span> combined_dataset)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>model2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = colony_n ~ colony_lost, data = combined_dataset)

Coefficients:
(Intercept)  colony_lost  
  21257.206        1.353  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic plots for model1:</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-05_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic plots for model2:</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-05_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="testing-linear-model" class="level2">
<h2 class="anchored" data-anchor-id="testing-linear-model">Testing Linear Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed:</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct 80% training/20% testing split:</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(combined_dataset<span class="sc">$</span>colony_n, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> combined_dataset[index, ]</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> combined_dataset[<span class="sc">-</span>index, ]</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the testing set</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, <span class="at">newdata =</span> test_data)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model performance on the testing set (you can use different metrics)</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co"># For example, you might want to use mean squared error (MSE)</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> test_data<span class="sc">$</span>colony_n)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Mean Squared Error on Test Set:"</span>, mse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean Squared Error on Test Set: 12135473.9700189"</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The methodologies and data mining techniques used for linear regression analysis in this report conclude insignificant and high unreliable findings when trying to predict the relationship between parasites and their effects on the decline of bee population. This indicates that the combined datasets needs to be re-evaluated and better filtered and imputed during the correlation analysis of the Exploratory Data Analysis process.</p>
<p>But most importantly, additional linear models must be chosen and used in cross-validation testing to determine the best model that will better fit the data than the singular model currently used in this analysis, which should therefore better predict the future Arizona bee population and how much the Varroa mite and other parasites may affect this population.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>